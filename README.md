## **Всем привет! :)**

Даны некоторые образовательные курсы и данные по ним в следующих таблицах:

![image](https://github.com/S1lencena/SQL_Calculate_metrics/assets/140109674/93ed9717-482e-436f-8337-942ef98f2623)

![image](https://github.com/S1lencena/SQL_Calculate_metrics/assets/140109674/04d3f526-d3eb-41e1-97a1-bb5208f26635)

Курсы состоят из различных уроков, каждый из которых состоит из нескольких маленьких заданий.
Назовём очень усердным учеником того пользователя, который хотя бы раз за текущий месяц правильно решил 20 горошин.

* **Задание 1**. Необходимо написать оптимальный запрос, который даст информацию о количестве очень усердных студентов.
* **Задание 2**. На образовательной платформе был проведен эксперимент, где был протестирован новый экран оплаты. Необходимо в одном запросе выгрузить следующую информацию
о группах пользователей:
- `ARPU` 
- `ARPAU`
- `CR` в покупку 
- `СR` активного пользователя в покупку 
- `CR` пользователя из активности по математике (subject = ’math’) в покупку курса по математике

ARPU считается относительно всех пользователей, попавших в группы.
Активным считается пользователь, за все время решивший больше 10 задач правильно в любых дисциплинах.
Активным по математике считается пользователь, за все время решивший 2 или больше задач правильно по математике.

Все данные находятся в табличном виде в Clickhouse. Подключение к ClickHouse через Python c использованием библиотеки pandahouse.

## Результаты расчетов ##
### Задание 1
![image](https://github.com/S1lencena/SQL_Calculate_metrics/assets/140109674/0f3b57da-07cd-4a28-a7bd-8b210e4ed4dc)

### Задание 2
![image](https://github.com/S1lencena/SQL_Calculate_metrics/assets/140109674/22f2b5b5-3ce7-4aba-89ad-c3f15c5596db)
